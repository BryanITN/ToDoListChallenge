<nav class="navbar navbar-expand-lg navbar-light bg-primary">
  <div class="container">
    <span class="navbar-brand text-dark">Joffroy</span>
    <span class="navbar-brand text-white">ToDoList</span>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <button class="btn text-white logout" (click)="logout()">
            Cerrar Sesión
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>
<h2 class="text-center my-2">Lista de tareas</h2>
<div class="container-task">
  <button
    pButton
    icon="pi pi-plus"
    class="new-button"
    styleClass="p-button-rounded"
    label="Agregar tarea"
    (click)="showNewDialog()"
  ></button>
  <p-table
    [value]="tasks"
    [paginator]="true"
    [rows]="5"
    [showCurrentPageReport]="true"
    [tableStyle]="{ 'min-width': '50rem' }"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} tareas"
    [rowsPerPageOptions]="[10, 25, 50]"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Id</th>
        <th>Título</th>
        <th>Descripción</th>
        <th>Estatus</th>
        <th>Fecha de creación</th>
        <th>Acciones</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-task>
      <tr>
        <td>{{ task.Id }}</td>
        <td>{{ task.Title }}</td>
        <td>{{ task.Description }}</td>
        <td>{{ task.StatusTaskDescription }}</td>
        <td>{{ task.CreatedDate | date : "dd-MM-yyyy" }}</td>
        <td class="actions-cell">
          <button pButton icon="pi pi-pencil" (click)="editTask(task)"></button>
          <button
            pButton
            icon="pi pi-trash"
            class="delete-button"
            title="Eliminar"
            (click)="confirmDelete(task)"
          ></button>
          <p-toast></p-toast>
          <p-confirmDialog [style]="{ width: '50vw' }"></p-confirmDialog>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <!-- Popup para edición de tarea -->
  <p-dialog header="Tarea" [(visible)]="displayEditDialog" [responsive]="true">
    <form [formGroup]="editForm" (ngSubmit)="onSubmit()">
      <div class="p-field">
        <div><label for="title">Título<sup>*</sup>:</label></div>
        <input
          id="title"
          type="text"
          formControlName="title"
          class="p-inputtext"
        />
      </div>
      <div class="p-field">
        <div><label for="description">Descripción<sup>*</sup>:</label></div>
        <input
          id="description"
          type="text"
          formControlName="description"
          class="p-inputtext"
        />
      </div>
      <div class="p-field">
        <div><label for="statusTaskId">Estatus<sup>*</sup>:</label></div>
        <p-dropdown
          id="statusTaskId"
          [options]="statusTaskOptions"
          optionLabel="Description"
          formControlName="statusTaskId"
        ></p-dropdown>
      </div>
      <button
        pButton
        type="submit"
        label="Guardar"
        [disabled]="editForm.invalid"
      ></button>
      <button
        pButton
        type="button"
        (click)="hideEditDialog()"
        label="Cancelar"
        class="p-button-secondary"
      ></button>
    </form>
  </p-dialog>
</div>
